@0
   MOV 0, RIGHT
ST:MOV UP, ACC
   MOV ACC, RIGHT
   JGZ GZ


EZ:MOV 1, DOWN
   JRO 0



GZ:JMP ST

@1
ST:MOV UP, ACC
   SAV
LP:SWP
   SAV
   SUB DOWN
   JEZ EZ

NZ:MOV 0, DOWN
   JMP LP

EZ:MOV -1, DOWN

@2
MOV UP, RIGHT

@3
MOV LEFT, NIL
ZD:MOV UP, DOWN
UD:MOV -1, RIGHT
   MOV UP, ACC
   MOV ACC, RIGHT
   MOV ACC, DOWN
   JNZ UD

ZU:MOV DOWN, UP
DU:MOV 1, RIGHT
   MOV DOWN, ACC
   MOV ACC, RIGHT
   MOV ACC, UP
   JNZ DU
   JMP ZD

@4
ST:MOV 10 ACC

LP:ADD LEFT
   MOV ACC, UP
   MOV LEFT, RIGHT
   MOV UP, RIGHT

   JMP LP

@5
ST:MOV LEFT, ACC
   SAV

LP:MOV LEFT, ACC
   JEZ ST


LZ:SWP
   MOV ACC, DOWN
   SWP

@6
##CELL <- VALUE

@7
MOV RIGHT, DOWN

@8
MOV UP, LEFT