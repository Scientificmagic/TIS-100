@0


@1
MOV UP, ACC

MOV ACC, RIGHT

MOV ACC, DOWN

@2
START:
  MOV LEFT, ACC
  JGZ DF
ELSE:MOV DOWN, NIL
     MOV 0, DOWN
     JMP START

DF:MOV ACC, RIGHT
   MOV DOWN, ACC
   SUB RIGHT
   JGZ NO #NO SAVE
MX:MOV RIGHT, DOWN
   JMP START
NO:MOV -1 DOWN
   MOV RIGHT, NIL

@3
MOV LEFT, ACC

MOV ACC, LEFT
MOV ACC, LEFT

@4
MOV RIGHT, ACC

MOV ACC, RIGHT
MOV ACC, RIGHT

@5
MOV UP, DOWN
ST:MOV UP, ACC
   JGZ DF
ELSE:MOV DOWN, NIL
     MOV 0, DOWN
     JRO -5
DF:MOV ACC, LEFT
   MOV DOWN, ACC
   SUB LEFT
   JLZ NO #NO SAVE
MX:MOV LEFT, DOWN
   JMP ST
NO:MOV -1 DOWN
   MOV LEFT, NIL
   JMP ST

@6
START:
  MOV ACC, UP
  SWP
  MOV UP, ACC
  JLZ CB   # -1
  JGZ SAVE # >0

PUSH:SWP # 0
     MOV ACC, DOWN
     MOV 0, ACC
     JMP START

SAVE: SAV #>0
      JMP START
CB:SWP

@7


@8
MOV UP, ACC
ST:MOV ACC, UP
   SWP
   MOV UP, ACC
   JLZ CB   # -1
   JGZ SAVE # >0

PUSH:SWP # 0
     MOV ACC, DOWN
     MOV 0, ACC
     JRO -9
SAVE: SAV #>0
      JMP ST
CB:SWP
   JMP ST

@9
MOV UP, DOWN

@10
#DF:CALCULATE DIFF
#MX:NEW MAX
#NO:DISCARD
#
#
#
#
#
#
#
#
#
#CB:CALLBACK
#
#